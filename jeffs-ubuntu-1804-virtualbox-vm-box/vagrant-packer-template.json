{
    "variables": {
        "autounattend": "./answer_files/10/Autounattend.xml",
        "disk_size": "61440",
        "disk_type_id": "1",
        "headless": "false",
        "iso_url": "./iso/SW_DVD9_Win_Pro_Ent_Edu_N_10_1803_64BIT_English_-4_MLF_X21-87129.ISO",
        "iso_checksum_type": "sha256",
        "iso_checksum": "F38B0AEAE0756E01DCD9B1600DE62416E04AA963C72CEA30929141F54F1235B3",
        "restart_timeout": "5m",
        "vhv_enable": "false",
        "winrm_timeout": "6h"
    },

    "builders": [
        {   
            "boot_command": "",
            "boot_wait": "6m",
            "communicator": "winrm",
            "disk_size": "{{user `disk_size`}}",
            "floppy_files": [
              "{{user `autounattend`}}",
              "./scripts/Install-Software.ps1"
            ],
            "guest_additions_mode": "disable",
            "guest_os_type": "Windows10_64",
            "headless": "{{user `headless`}}",
            "iso_checksum": "{{user `iso_checksum`}}",
            "shutdown_command": "shutdown /s /t 10 /f /d p:4:1 /c \"Packer Shutdown\"",
            "iso_checksum_type": "{{user `iso_checksum_type`}}",
            "iso_url": "{{user `iso_url`}}",
            "type": "virtualbox-iso",
            "vboxmanage": [
              [
                "modifyvm",
                "{{.Name}}",
                "--memory",
                "6096"
              ],
              [
                "modifyvm",
                "{{.Name}}",
                "--cpus",
                "4"
              ]
            ],
            "vm_name": "windows_10",
            "winrm_password": "vagrant",
            "winrm_timeout": "{{user `winrm_timeout`}}",
            "winrm_username": "vagrant"
        }
    ],

    "provisioners": [
        {
            "type": "file",
            "source": "./install-files/welcome.txt",
            "destination": "/tmp/welcome.txt"
        },
        {
            "type": "shell",
            "pause_before": "4s",
            "execute_command": "chmod +x {{ .Path }}; {{ .Vars }} sudo -E {{ .Path }}",
            "scripts": [
                "./install-scripts/add-user-jeff.sh",
                "./install-scripts/move-welcome-file.sh",
                "./install-scripts/setup-github-ssh-keys.sh",
                "./install-scripts/upgrade-system.sh",
                "./install-scripts/install-packages.sh",
                "./install-scripts/install-docker.sh",
                "./install-scripts/install-go.sh",
                "./install-scripts/pull-private-repos.sh",
                "./install-scripts/install-service.sh",
                "./install-scripts/enable-service-boot.sh",
                "./install-scripts/enable-docker-container-boot.sh"
            ]
        }
    ],

    "post-processors": [
        {
            "keep_input_artifact": false,
            "output": "ubuntu-18.04-{{.Provider}}.box",
            "type": "vagrant",
            "vagrantfile_template": "vagrantfile-windows_10.template"
        }
    ]

}
